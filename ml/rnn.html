<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RNNs — Illustrated Cheatsheet (LSTM • GRU • Encoder–Decoder • Attention)</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Alpine.js -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- MathJax (v3) -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [["$", "$"], ["\\(", "\\)"]],
        displayMath: [["$$", "$$"], ["\\[", "\\]"]]
      },
      chtml: { linebreaks: { automatic: false }, matchFontHeight: true },
      options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>

  <style>
    :root { color-scheme: light; }
    html { scroll-behavior: smooth; }
    .bg-hero {
      background: linear-gradient(120deg, #f0f9ff, #f0fdf4, #eef2ff);
      background-size: 200% 200%;
      animation: grad 18s ease infinite;
    }
    @keyframes grad { 0% {background-position:0% 50} 50% {background-position:100% 50%} 100% {background-position:0% 50%} }
    .code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
    mjx-container[jax="SVG"][display="inline"] { white-space: nowrap; }
    .math-nowrap { white-space: nowrap; overflow-x: auto; -webkit-overflow-scrolling: touch; }
    mjx-container[jax="SVG"][display="true"] { display: block; overflow-x: auto; }
    .card { backdrop-filter: blur(6px); }
    .node { filter: drop-shadow(0 2px 2px rgba(0,0,0,.06)); }
  </style>
</head>

<body class="min-h-screen text-slate-800">

  <!-- Header -->
  <header class="bg-hero">
    <div class="max-w-7xl mx-auto px-6 py-12 lg:py-16">
      <div class="flex flex-col lg:flex-row items-center gap-10">
        <div class="flex-1">
          <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight text-slate-900">
            Recurrent Neural Networks <span class="text-indigo-600">Illustrated</span> Cheatsheet
          </h1>
          <p class="mt-3 text-lg md:text-xl text-slate-700 max-w-2xl">
            A single-file reference to RNN basics, LSTMs, GRUs, bidirectional RNNs, encoder–decoder models, and attention — with compact math and SVG diagrams.
          </p>
          <div class="mt-5 flex flex-wrap gap-3">
            <a href="#rnn-basics" class="px-5 py-3 rounded-xl bg-indigo-600 text-white font-semibold shadow hover:bg-indigo-700">Start here</a>
            <a href="#cells" class="px-5 py-3 rounded-xl bg-white ring-1 ring-slate-200 shadow-sm font-semibold hover:bg-slate-50">LSTM & GRU</a>
            <a href="#seq2seq" class="px-5 py-3 rounded-xl bg-white ring-1 ring-slate-200 shadow-sm font-semibold hover:bg-slate-50">Encoder–Decoder</a>
            <a href="#attention" class="px-5 py-3 rounded-xl bg-white ring-1 ring-slate-200 shadow-sm font-semibold hover:bg-slate-50">Attention</a>
          </div>
          <p class="mt-4 text-sm text-slate-500">Single file • Tailwind + Alpine • MathJax • Pure SVG diagrams</p>
        </div>
        <div class="flex-1 w-full">
          <div class="bg-white/70 card rounded-2xl p-6 shadow border border-slate-100">
            <p class="text-center text-slate-700"><span class="font-semibold">Cheat code:</span> Use <span class="code">tanh</span> for hidden states, <span class="code">sigmoid</span> for gates, clip grads (1.0), try <span class="code">AdamW(1e-3)</span>, and pack/pad variable lengths.</p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- RNN Basics -->
  <section id="rnn-basics" class="py-12">
    <div class="max-w-7xl mx-auto px-6">
      <div class="mb-8">
        <h2 class="text-3xl font-bold tracking-tight text-slate-900">RNN Basics</h2>
        <p class="mt-2 text-slate-600 max-w-3xl">Share parameters across time to model sequences. Hidden state $h_t$ summarizes the past.</p>
      </div>
      <div class="grid lg:grid-cols-2 gap-6">
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">Vanilla RNN (Elman)</h3>
          <div class="text-sm leading-7 text-slate-700 space-y-2">
            <p class="math-nowrap">$h_t = \phi(W_x x_t + W_h h_{t-1} + b)$, $\; y_t = W_y h_t + c$</p>
            <p>Problems: vanishing/exploding gradients for long dependencies. Solutions: gating (LSTM/GRU), residuals, norm, orthogonal init, gradient clipping.</p>
          </div>
          <svg viewBox="0 0 560 160" class="w-full h-auto mt-3">
            <defs>
              <marker id="arr" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/></marker>
            </defs>
            <g class="node" font-size="12" fill="#334155">
              <rect x="80" y="40" width="80" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/>
              <text x="120" y="65" text-anchor="middle">$h_{t-1}$</text>
              <rect x="240" y="40" width="80" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/>
              <text x="280" y="65" text-anchor="middle">$h_t$</text>
              <rect x="400" y="40" width="80" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/>
              <text x="440" y="65" text-anchor="middle">$h_{t+1}$</text>
            </g>
            <g stroke="#94a3b8" marker-end="url(#arr)" fill="none">
              <line x1="160" y1="60" x2="240" y2="60"/>
              <line x1="320" y1="60" x2="400" y2="60"/>
              <line x1="280" y1="20" x2="280" y2="40"/>
            </g>
            <g font-size="11" fill="#64748b">
              <text x="280" y="16" text-anchor="middle">$x_t$</text>
            </g>
            <circle cx="280" cy="20" r="6" fill="#e0e7ff" stroke="#c7d2fe"/>
          </svg>
        </article>
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">Bidirectional RNN</h3>
          <p class="mt-2 text-sm text-slate-700">Run forward and backward; concatenate states: $h_t^{bi} = [\overrightarrow{h_t};\,\overleftarrow{h_t}]$.</p>
          <svg viewBox="0 0 560 160" class="w-full h-auto mt-3">
            <defs><marker id="arr2" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/></marker></defs>
            <g font-size="12" fill="#334155">
              <rect x="120" y="40" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="160" y="62" text-anchor="middle">$\rightarrow$</text>
              <rect x="120" y="88" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="160" y="110" text-anchor="middle">$\leftarrow$</text>
              <rect x="360" y="60" width="100" height="40" rx="10" fill="#fff" stroke="#e2e8f0"/>
              <text x="410" y="85" text-anchor="middle">concat</text>
            </g>
            <g stroke="#94a3b8" marker-end="url(#arr2)" fill="none">
              <line x1="80" y1="58" x2="120" y2="58"/>
              <line x1="200" y1="58" x2="360" y2="80"/>
              <line x1="200" y1="106" x2="360" y2="80"/>
              <line x1="80" y1="106" x2="120" y2="106"/>
            </g>
            <g font-size="11" fill="#64748b">
              <text x="80" y="56" text-anchor="end">$x_1 .. x_T$</text>
            </g>
          </svg>
        </article>
      </div>
    </div>
  </section>

  <!-- LSTM & GRU -->
  <section id="cells" class="py-12 bg-slate-50">
    <div class="max-w-7xl mx-auto px-6">
      <h2 class="text-3xl font-bold tracking-tight text-slate-900">LSTM & GRU Cells</h2>
      <p class="mt-2 text-slate-600 max-w-3xl">Gates control information flow; cell state $c_t$ (LSTM) enables long-term memory.</p>
      <div class="mt-6 grid lg:grid-cols-2 gap-6">
        <!-- LSTM -->
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">LSTM — Math</h3>
          <div class="text-sm text-slate-700 leading-7">
            \[
            \begin{aligned}
              i_t &= \sigma(W_i x_t + U_i h_{t-1} + b_i) \\
              f_t &= \sigma(W_f x_t + U_f h_{t-1} + b_f) \\
              o_t &= \sigma(W_o x_t + U_o h_{t-1} + b_o) \\
              \tilde{c}_t &= \tanh(W_c x_t + U_c h_{t-1} + b_c) \\
              c_t &= f_t \odot c_{t-1} + i_t \odot \tilde{c}_t \\
              h_t &= o_t \odot \tanh(c_t)
            \end{aligned}
            \]
          </div>
          <h4 class="mt-4 text-sm font-semibold text-slate-600">LSTM Cell (SVG)</h4>
          <svg viewBox="0 0 720 280" class="w-full h-auto mt-2">
            <defs>
              <marker id="arr3" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/></marker>
            </defs>
            <!-- cell box -->
            <rect x="160" y="20" width="400" height="240" rx="16" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="360" y="38" text-anchor="middle" font-size="12" fill="#475569">LSTM Cell</text>

            <!-- inputs -->
            <text x="60" y="70" text-anchor="end" font-size="12" fill="#64748b">$x_t$</text>
            <circle cx="80" cy="66" r="8" fill="#e0e7ff" stroke="#c7d2fe"/>
            <text x="60" y="210" text-anchor="end" font-size="12" fill="#64748b">$h_{t-1}$</text>
            <circle cx="80" cy="206" r="8" fill="#e0e7ff" stroke="#c7d2fe"/>

            <!-- arrows into cell -->
            <g stroke="#94a3b8" marker-end="url(#arr3)" fill="none">
              <line x1="88" y1="66" x2="160" y2="66"/>
              <line x1="88" y1="206" x2="160" y2="206"/>
            </g>

            <!-- gates rows -->
            <g font-size="12" fill="#334155">
              <rect x="200" y="60" width="120" height="34" rx="8" fill="#fff" stroke="#e2e8f0"/>
              <text x="260" y="81" text-anchor="middle">$f_t$ (forget)</text>
              <rect x="200" y="104" width="120" height="34" rx="8" fill="#fff" stroke="#e2e8f0"/>
              <text x="260" y="125" text-anchor="middle">$i_t$ (input)</text>
              <rect x="200" y="148" width="120" height="34" rx="8" fill="#fff" stroke="#e2e8f0"/>
              <text x="260" y="169" text-anchor="middle">$\tilde{c}_t$</text>
              <rect x="200" y="192" width="120" height="34" rx="8" fill="#fff" stroke="#e2e8f0"/>
              <text x="260" y="213" text-anchor="middle">$o_t$ (output)</text>
            </g>

            <!-- c_{t-1} to c_t highway -->
            <rect x="360" y="60" width="260" height="34" rx="6" fill="#f8fafc" stroke="#e2e8f0"/>
            <text x="490" y="81" text-anchor="middle" font-size="12" fill="#64748b">$c_t = f_t\odot c_{t-1} + i_t\odot\tilde{c}_t$</text>

            <!-- combine + output h_t -->
            <g>
              <rect x="460" y="192" width="160" height="34" rx="6" fill="#f8fafc" stroke="#e2e8f0"/>
              <text x="540" y="213" text-anchor="middle" font-size="12" fill="#64748b">$h_t = o_t\odot\tanh(c_t)$</text>
            </g>

            <!-- outputs -->
            <text x="660" y="70" font-size="12" fill="#64748b">$c_t$</text>
            <circle cx="640" cy="66" r="8" fill="#dcfce7" stroke="#86efac"/>
            <text x="660" y="210" font-size="12" fill="#64748b">$h_t$</text>
            <circle cx="640" cy="206" r="8" fill="#dcfce7" stroke="#86efac"/>

            <!-- arrows out -->
            <g stroke="#94a3b8" marker-end="url(#arr3)" fill="none">
              <line x1="620" y1="66" x2="640" y2="66"/>
              <line x1="620" y1="206" x2="640" y2="206"/>
            </g>
          </svg>
        </article>

        <!-- GRU -->
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">GRU — Math</h3>
          <div class="text-sm text-slate-700 leading-7">
            \[
            \begin{aligned}
              z_t &= \sigma(W_z x_t + U_z h_{t-1} + b_z)\\
              r_t &= \sigma(W_r x_t + U_r h_{t-1} + b_r)\\
              \tilde{h}_t &= \tanh(W_h x_t + U_h(r_t \odot h_{t-1}) + b_h)\\
              h_t &= (1 - z_t) \odot h_{t-1} + z_t \odot \tilde{h}_t
            \end{aligned}
            \]
          </div>
          <h4 class="mt-4 text-sm font-semibold text-slate-600">GRU Cell (SVG)</h4>
          <svg viewBox="0 0 700 240" class="w-full h-auto mt-2">
            <defs><marker id="arr4" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/></marker></defs>
            <rect x="150" y="20" width="400" height="200" rx="16" fill="#ffffff" stroke="#e2e8f0"/>
            <text x="350" y="36" text-anchor="middle" font-size="12" fill="#475569">GRU Cell</text>

            <text x="60" y="72" text-anchor="end" font-size="12" fill="#64748b">$x_t$</text>
            <circle cx="80" cy="68" r="8" fill="#e0e7ff" stroke="#c7d2fe"/>
            <text x="60" y="172" text-anchor="end" font-size="12" fill="#64748b">$h_{t-1}$</text>
            <circle cx="80" cy="168" r="8" fill="#e0e7ff" stroke="#c7d2fe"/>

            <g stroke="#94a3b8" marker-end="url(#arr4)" fill="none">
              <line x1="88" y1="68" x2="150" y2="68"/>
              <line x1="88" y1="168" x2="150" y2="168"/>
            </g>

            <!-- gates + candidate -->
            <g font-size="12" fill="#334155">
              <rect x="190" y="56" width="110" height="30" rx="7" fill="#fff" stroke="#e2e8f0"/>
              <text x="245" y="76" text-anchor="middle">$z_t$ (update)</text>
              <rect x="190" y="96" width="110" height="30" rx="7" fill="#fff" stroke="#e2e8f0"/>
              <text x="245" y="116" text-anchor="middle">$r_t$ (reset)</text>
              <rect x="190" y="136" width="150" height="30" rx="7" fill="#fff" stroke="#e2e8f0"/>
              <text x="265" y="156" text-anchor="middle">$\tilde{h}_t$</text>
            </g>

            <!-- output blend -->
            <rect x="370" y="96" width="160" height="30" rx="7" fill="#f8fafc" stroke="#e2e8f0"/>
            <text x="450" y="116" text-anchor="middle" font-size="12" fill="#64748b">$h_t=(1-z)\odot h_{t-1}+z\odot\tilde{h}$</text>

            <text x="640" y="118" font-size="12" fill="#64748b">$h_t$</text>
            <circle cx="620" cy="114" r="8" fill="#dcfce7" stroke="#86efac"/>
            <g stroke="#94a3b8" marker-end="url(#arr4)" fill="none">
              <line x1="530" y1="114" x2="620" y2="114"/>
            </g>
          </svg>
        </article>
      </div>

      <!-- Tips cards -->
      <div class="mt-6 grid md:grid-cols-3 gap-4">
        <div class="bg-white rounded-2xl shadow p-4 border">
          <div class="text-sm text-slate-500">Practical Defaults</div>
          <ul class="mt-2 text-xs leading-6 text-slate-700 list-disc ml-5">
            <li>Use <span class="code">tanh</span> states, <span class="code">sigmoid</span> gates; dropout on inputs/recurrent (variational).</li>
            <li>Clip gradients to 1.0; try <span class="code">AdamW(1e-3)</span>.</li>
            <li>Pack padded sequences; mask loss on pads.</li>
          </ul>
        </div>
        <div class="bg-white rounded-2xl shadow p-4 border">
          <div class="text-sm text-slate-500">When to prefer</div>
          <ul class="mt-2 text-xs leading-6 text-slate-700 list-disc ml-5">
            <li><b>LSTM</b>: longer-range, stable memory ($c_t$ highway).</li>
            <li><b>GRU</b>: fewer params, faster; competitive on many tasks.</li>
          </ul>
        </div>
        <div class="bg-white rounded-2xl shadow p-4 border">
          <div class="text-sm text-slate-500">Shapes</div>
          <div class="text-xs text-slate-700 mt-2">Batch × Time × Features; hidden dim $H$, vocab $V$.</div>
          <div class="text-xs text-slate-600 mt-1">Inputs: $(B,T,D)$ → RNN → $(B,T,H)$ → head.</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Encoder–Decoder basics -->
  <section id="seq2seq" class="py-12">
    <div class="max-w-7xl mx-auto px-6">
      <h2 class="text-3xl font-bold tracking-tight text-slate-900">Encoder–Decoder (Seq2Seq)</h2>
      <p class="mt-2 text-slate-600 max-w-3xl">Map input sequence to output sequence. The encoder summarizes inputs; the decoder generates outputs conditioned on that summary (and optionally attention).</p>

      <div class="mt-6 grid lg:grid-cols-2 gap-6">
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">Without Attention</h3>
          <p class="text-sm text-slate-700 mt-1">Encoder final state $h_T$ initializes decoder; teacher forcing during training.</p>
          <svg viewBox="0 0 740 220" class="w-full h-auto mt-2">
            <defs><marker id="arr5" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/></marker></defs>
            <!-- encoder boxes -->
            <g font-size="12" fill="#334155">
              <rect x="60" y="40" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="100" y="62" text-anchor="middle">enc $h_1$</text>
              <rect x="160" y="40" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="200" y="62" text-anchor="middle">enc $h_2$</text>
              <rect x="260" y="40" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="300" y="62" text-anchor="middle">enc $h_T$</text>
            </g>
            <g stroke="#94a3b8" marker-end="url(#arr5)" fill="none">
              <line x1="140" y1="58" x2="160" y2="58"/>
              <line x1="240" y1="58" x2="260" y2="58"/>
              <line x1="300" y1="76" x2="300" y2="120"/>
            </g>
            <text x="300" y="92" text-anchor="middle" font-size="11" fill="#64748b">$h_T$</text>

            <!-- decoder chain -->
            <g font-size="12" fill="#334155">
              <rect x="260" y="120" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="300" y="142" text-anchor="middle">dec $s_0$</text>
              <rect x="360" y="120" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="400" y="142" text-anchor="middle">dec $s_1$</text>
              <rect x="460" y="120" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="500" y="142" text-anchor="middle">dec $s_2$</text>
              <rect x="560" y="120" width="80" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="600" y="142" text-anchor="middle">dec $s_U$</text>
            </g>
            <g stroke="#94a3b8" marker-end="url(#arr5)" fill="none">
              <line x1="340" y1="138" x2="360" y2="138"/>
              <line x1="440" y1="138" x2="460" y2="138"/>
              <line x1="540" y1="138" x2="560" y2="138"/>
            </g>
            <g font-size="11" fill="#64748b">
              <text x="400" y="116" text-anchor="middle">$y_{0\rightarrow1}$ (teacher forcing)</text>
              <text x="600" y="116" text-anchor="middle">$\hat{y}_t=\mathrm{softmax}(Ws_t)$</text>
            </g>
          </svg>
        </article>

        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">With Attention (Bahdanau/Luong)</h3>
          <p class="text-sm text-slate-700 mt-1">Decoder state $s_t$ attends over all encoder states $h_1..h_T$ to build context $c_t$.</p>
          <div class="text-xs text-slate-700 mt-2 math-nowrap">
            $\alpha_{t,i}=\mathrm{softmax}_i(\mathrm{score}(s_t, h_i))$,\quad $c_t=\sum_i \alpha_{t,i} h_i$,\quad $s_{t+1}=\mathrm{RNN}(s_t,[y_t;c_t])$
          </div>
          <svg viewBox="0 0 820 300" class="w-full h-auto mt-3">
            <defs><marker id="arr6" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L6,3 z" fill="#94a3b8"/></marker></defs>
            <!-- encoder states row -->
            <g font-size="12" fill="#334155">
              <rect x="80" y="40" width="80" height="34" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="120" y="61" text-anchor="middle">$h_1$</text>
              <rect x="180" y="40" width="80" height="34" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="220" y="61" text-anchor="middle">$h_2$</text>
              <rect x="280" y="40" width="80" height="34" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="320" y="61" text-anchor="middle">$h_3$</text>
              <rect x="380" y="40" width="80" height="34" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="420" y="61" text-anchor="middle">$h_T$</text>
            </g>

            <!-- decoder state -->
            <g font-size="12" fill="#334155">
              <rect x="520" y="160" width="90" height="36" rx="9" fill="#fff" stroke="#e2e8f0"/>
              <text x="565" y="182" text-anchor="middle">$s_t$</text>
            </g>

            <!-- attention lines -->
            <g stroke="#94a3b8" marker-end="url(#arr6)" fill="none" opacity="0.9">
              <line x1="520" y1="178" x2="120" y2="74"/>
              <line x1="520" y1="178" x2="220" y2="74"/>
              <line x1="520" y1="178" x2="320" y2="74"/>
              <line x1="520" y1="178" x2="420" y2="74"/>
            </g>

            <!-- context box -->
            <rect x="620" y="150" width="120" height="56" rx="10" fill="#f8fafc" stroke="#e2e8f0"/>
            <text x="680" y="178" text-anchor="middle" font-size="12" fill="#64748b">$c_t=\sum \alpha h$</text>

            <!-- output head -->
            <g font-size="12" fill="#334155">
              <rect x="760" y="150" width="40" height="56" rx="10" fill="#fff" stroke="#e2e8f0"/>
              <text x="780" y="180" text-anchor="middle">$\hat{y}_t$</text>
            </g>
            <g stroke="#94a3b8" marker-end="url(#arr6)" fill="none">
              <line x1="710" y1="178" x2="760" y2="178"/>
            </g>
            <text x="565" y="212" text-anchor="middle" font-size="11" fill="#64748b">score: dot / additive</text>
          </svg>
        </article>
      </div>

      <!-- Quick recipes -->
      <div class="mt-8 grid lg:grid-cols-3 gap-6">
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h4 class="text-lg font-semibold">Seq Tagging (NER, POS)</h4>
          <ul class="mt-2 text-sm leading-7 text-slate-700 list-disc ml-5">
            <li>Embed → BiLSTM(256) → Dropout(0.3) → Dense(C) softmax</li>
            <li>Mask pads; CRF head optional for structured decoding</li>
          </ul>
        </article>
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h4 class="text-lg font-semibold">MT (small)</h4>
          <ul class="mt-2 text-sm leading-7 text-slate-700 list-disc ml-5">
            <li>Enc: 2×BiLSTM(512); Dec: 2×LSTM(512) + Luong attention</li>
            <li>Label smoothing 0.1; beam search 4; length penalty</li>
          </ul>
        </article>
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h4 class="text-lg font-semibold">Time Series Forecast</h4>
          <ul class="mt-2 text-sm leading-7 text-slate-700 list-disc ml-5">
            <li>GRU(128) → GRU(64) → Dense(H) (horizon)</li>
            <li>Scale inputs; teacher forcing; MSE/Huber; horizon loss weighting</li>
          </ul>
        </article>
      </div>
    </div>
  </section>

  <!-- Best Practices / Debugging -->
  <section id="tips" class="py-12 bg-slate-50">
    <div class="max-w-7xl mx-auto px-6">
      <h2 class="text-3xl font-bold tracking-tight text-slate-900">Best Practices & Debugging</h2>
      <div class="mt-6 grid lg:grid-cols-3 gap-6">
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">Training Hygiene</h3>
          <ul class="mt-2 text-sm leading-7 text-slate-700 list-disc ml-5">
            <li>Clip grads; use weight tying in language models (tie input/output embeddings).</li>
            <li>Use scheduled sampling sparingly; monitor exposure bias.</li>
            <li>LayerNorm/RMSNorm inside cells improves stability (esp. deep stacks).</li>
          </ul>
        </article>
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">Common Gotchas</h3>
          <ul class="mt-2 text-sm leading-7 text-slate-700 list-disc ml-5">
            <li>Mismatched padding masks between encoder and attention.</li>
            <li>Stateful vs stateless APIs; reset hidden states between sequences.</li>
            <li>Teacher forcing too high → poor free-running performance.</li>
          </ul>
        </article>
        <article class="bg-white border border-slate-200 rounded-2xl p-6 shadow">
          <h3 class="text-xl font-semibold">Parameter Counts</h3>
          <div class="text-sm text-slate-700">
            LSTM: $4(D\cdot H + H\cdot H + H)$; GRU: $3(D\cdot H + H\cdot H + H)$.
          </div>
          <div class="text-xs text-slate-500 mt-2">(Four gates vs three sets of parameters.)</div>
        </article>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-10 bg-slate-900 text-slate-200">
    <div class="max-w-7xl mx-auto px-6">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <p class="text-sm">© <span id="year"></span> RNNs Cheatsheet — Single-file</p>
        <div class="text-xs text-slate-400">Tailwind • Alpine.js • MathJax • SVG</div>
      </div>
    </div>
  </footer>

  <!-- Small boot script -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const y = document.getElementById('year'); if (y) y.textContent = new Date().getFullYear();
      // Ensure MathJax re-typesets after diagrams are in DOM
      setTimeout(() => { if (window.MathJax && MathJax.typesetPromise) MathJax.typesetPromise(); }, 60);
    });
  </script>

</body>
</html>
