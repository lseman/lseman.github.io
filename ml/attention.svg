<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 920 340"
   class="w-full h-auto mt-4"
   version="1.1"
   id="svg39"
   sodipodi:docname="attention.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview39"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1" />
  <style
     id="style1">
    .lbl{font:600 12px ui-sans-serif,system-ui,-apple-system,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial}
    .wire{fill:none;stroke:#64748b;stroke-width:2}
    .gate{fill:#f1f5f9;stroke:#94a3b8;stroke-width:2}
    .inDot circle{fill:#94a3b8}
    .stateDot circle{fill:#111827}
    .small{font:500 11px ui-sans-serif,system-ui,-apple-system,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial}
    .tiny{font:500 10px ui-sans-serif,system-ui,-apple-system,&quot;Segoe UI&quot;,Roboto,&quot;Helvetica Neue&quot;,Arial}
  </style>
  <defs
     id="defs6">
    <marker
       style="overflow:visible"
       id="marker43"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path43" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker42"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path42" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker41"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path41" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker40"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path40" />
    </marker>
    <marker
       style="overflow:visible"
       id="marker39"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path39" />
    </marker>
    <marker
       style="overflow:visible"
       id="Triangle"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Triangle arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt"
         d="M 5.77,0 -2.88,5 V -5 Z"
         id="path135" />
    </marker>
    <marker
       id="arrC"
       markerWidth="8"
       markerHeight="8"
       refX="7"
       refY="4"
       orient="auto"
       markerUnits="strokeWidth"
       viewBox="0 0 8 8"
       preserveAspectRatio="xMidYMid">
      <path
         d="M0,0 L0,8 L8,4 z"
         fill="#64748b"
         id="path1" />
    </marker>
    <linearGradient
       id="encGrad"
       x1="0%"
       y1="0%"
       x2="100%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#fef3c7"
         id="stop1" />
      <stop
         offset="100%"
         style="stop-color:#fde68a"
         id="stop2" />
    </linearGradient>
    <linearGradient
       id="decGrad"
       x1="0%"
       y1="0%"
       x2="100%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#dbeafe"
         id="stop3" />
      <stop
         offset="100%"
         style="stop-color:#bfdbfe"
         id="stop4" />
    </linearGradient>
    <linearGradient
       id="attGrad"
       x1="0%"
       y1="0%"
       x2="100%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#e9d5ff"
         id="stop5" />
      <stop
         offset="100%"
         style="stop-color:#c4b5fd"
         id="stop6" />
    </linearGradient>
  </defs>
  <!-- Inputs -->
  <g
     class="inDot"
     id="g8">
    <circle
       cx="90"
       cy="36"
       r="10"
       id="circle6" />
    <circle
       cx="210"
       cy="36"
       r="10"
       id="circle7" />
    <circle
       cx="330"
       cy="36"
       r="10"
       id="circle8" />
  </g>
  <text
     x="108"
     y="56"
     class="lbl"
     text-anchor="middle"
     id="text8"
     style="font-style:normal;font-variant:normal;font-weight:600;font-stretch:normal;font-size:12px;line-height:normal;font-family:ui-sans-serif, system-ui, '-apple-system', 'Segoe UI', Roboto, 'Helvetica Neue', Arial">x₁</text>
  <text
     x="224"
     y="56"
     class="lbl"
     text-anchor="middle"
     id="text9"
     style="font-style:normal;font-variant:normal;font-weight:600;font-stretch:normal;font-size:12px;line-height:normal;font-family:ui-sans-serif, system-ui, '-apple-system', 'Segoe UI', Roboto, 'Helvetica Neue', Arial">x₂</text>
  <text
     x="342"
     y="56"
     class="lbl"
     text-anchor="middle"
     id="text10"
     style="font-style:normal;font-variant:normal;font-weight:600;font-stretch:normal;font-size:12px;line-height:normal;font-family:ui-sans-serif, system-ui, '-apple-system', 'Segoe UI', Roboto, 'Helvetica Neue', Arial">x₃</text>
  <!-- Encoder cells -->
  <g
     id="g14">
    <rect
       x="50"
       y="72"
       width="80"
       height="52"
       fill="url(#encGrad)"
       stroke="#f59e0b"
       stroke-width="2"
       rx="10"
       id="rect10" />
    <rect
       x="170"
       y="72"
       width="80"
       height="52"
       fill="url(#encGrad)"
       stroke="#f59e0b"
       stroke-width="2"
       rx="10"
       id="rect11" />
    <rect
       x="290"
       y="72"
       width="80"
       height="52"
       fill="url(#encGrad)"
       stroke="#f59e0b"
       stroke-width="2"
       rx="10"
       id="rect12" />
    <text
       x="90"
       y="103"
       class="lbl"
       text-anchor="middle"
       id="text12">Enc</text>
    <text
       x="210"
       y="103"
       class="lbl"
       text-anchor="middle"
       id="text13">Enc</text>
    <text
       x="330"
       y="103"
       class="lbl"
       text-anchor="middle"
       id="text14">Enc</text>
  </g>
  <!-- Encoder wiring -->
  <g
     class="wire"
     marker-end="url(#arrC)"
     id="g18">
    <path
       d="M90,46 V72"
       id="path14" />
    <path
       d="M210,46 V72"
       id="path15" />
    <path
       d="M330,46 V72"
       id="path16" />
    <path
       d="M130,98 H170"
       id="path17" />
    <path
       d="M250,98 H290"
       id="path18" />
  </g>
  <!-- Encoder Memory (K,V) -->
  <rect
     x="420"
     y="74"
     width="130"
     height="56"
     class="gate"
     rx="10"
     id="rect18" />
  <text
     x="485"
     y="96"
     class="lbl"
     text-anchor="middle"
     id="text18">Encoder Memory</text>
  <text
     x="485"
     y="112"
     class="tiny"
     text-anchor="middle"
     id="text19">K, V (all steps)</text>
  <path
     class="wire"
     marker-end="url(#arrC)"
     d="M370,98 H420"
     id="path19" />
  <!-- Decoder cells -->
  <g
     id="g23">
    <rect
       x="470"
       y="210"
       width="88"
       height="52"
       fill="url(#decGrad)"
       stroke="#3b82f6"
       stroke-width="2"
       rx="10"
       id="rect19" />
    <rect
       x="590"
       y="210"
       width="88"
       height="52"
       fill="url(#decGrad)"
       stroke="#3b82f6"
       stroke-width="2"
       rx="10"
       id="rect20" />
    <rect
       x="710"
       y="210"
       width="88"
       height="52"
       fill="url(#decGrad)"
       stroke="#3b82f6"
       stroke-width="2"
       rx="10"
       id="rect21" />
    <text
       x="514"
       y="241"
       class="lbl"
       text-anchor="middle"
       id="text21">Dec t₁</text>
    <text
       x="634"
       y="241"
       class="lbl"
       text-anchor="middle"
       id="text22">Dec t₂</text>
    <text
       x="754"
       y="241"
       class="lbl"
       text-anchor="middle"
       id="text23">Dec t₃</text>
  </g>
  <!-- Decoder recurrent wiring -->
  <g
     class="wire"
     marker-end="url(#arrC)"
     id="g24">
    <path
       d="M558,236 H590"
       id="path23" />
    <path
       d="M678,236 H710"
       id="path24" />
  </g>
  <!-- BOS -->
  <g
     class="stateDot"
     id="g25">
    <circle
       cx="452"
       cy="236"
       r="8"
       id="circle24" />
  </g>
  <text
     x="452"
     y="254"
     class="tiny"
     text-anchor="middle"
     id="text25">[BOS]</text>
  <path
     class="wire"
     marker-end="url(#arrC)"
     d="M460,236 H470"
     id="path25" />
  <!-- Cross-Attention (moved to very top) -->
  <rect
     x="600"
     y="16"
     width="220"
     height="84"
     fill="url(#attGrad)"
     stroke="#7c3aed"
     stroke-width="2"
     rx="12"
     id="rect25" />
  <text
     x="710"
     y="34"
     class="lbl"
     text-anchor="middle"
     fill="#4c1d95"
     id="text26">Cross-Attention</text>
  <!-- Heads -->
  <g
     id="g30">
    <rect
       x="612"
       y="46"
       width="196"
       height="14"
       rx="7"
       fill="#ede9fe"
       stroke="#7c3aed"
       stroke-width="1"
       id="rect26" />
    <rect
       x="612"
       y="64"
       width="196"
       height="14"
       rx="7"
       fill="#ede9fe"
       stroke="#7c3aed"
       stroke-width="1"
       id="rect27" />
    <rect
       x="612"
       y="82"
       width="196"
       height="14"
       rx="7"
       fill="#ede9fe"
       stroke="#7c3aed"
       stroke-width="1"
       id="rect28" />
    <text
       x="710"
       y="57"
       class="tiny"
       text-anchor="middle"
       id="text28">Head 1: Attn(Q,K,V)</text>
    <text
       x="710"
       y="75"
       class="tiny"
       text-anchor="middle"
       id="text29">Head 2: Attn(Q,K,V)</text>
    <text
       x="710"
       y="93"
       class="tiny"
       text-anchor="middle"
       id="text30">Head 3: Attn(Q,K,V)</text>
  </g>
  <!-- Clean orthogonal arrows -->
  <!-- K,V: memory → attention (right, up, right) -->
  <g
     class="wire"
     marker-end="url(#arrC)"
     id="g31">
    <path
       d="M550,102 H580 V46 H600"
       id="path30" />
  </g>
  <text
     x="556"
     y="62"
     class="tiny"
     id="text31"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:10px;line-height:normal;font-family:ui-sans-serif, system-ui, '-apple-system', 'Segoe UI', Roboto, 'Helvetica Neue', Arial">K,V</text>
  <!-- Q up: each decoder cell top → attention bottom -->
  <!-- top edge of each decoder cell is y=210 -->
  <g
     class="wire"
     marker-end="url(#arrC)"
     id="g33">
    <!-- t1 center x=514 -->
    <path
       d="m 519.70826,205.56025 c 45.08807,-36.26717 93.13277,-68.5737 139.91254,-102.56518"
       id="path31"
       sodipodi:nodetypes="cc"
       style="marker-start:url(#Triangle);marker-end:url(#marker39)" />
    <!-- t2 center x=634 -->
    <path
       d="m 637.71031,203.59128 c 24.70431,-35.08717 47.3748,-62.40204 71.50117,-97.88678"
       id="path32"
       sodipodi:nodetypes="cc"
       style="marker-start:url(#marker41);marker-end:url(#marker40)" />
    <!-- t3 center x=754 -->
    <path
       d="m 754,202.91668 c -0.0324,-36.16434 -0.51164,-59.508 0.0284,-95.66816"
       id="path33"
       sodipodi:nodetypes="cc"
       style="marker-start:url(#marker43);marker-end:url(#marker42)" />
  </g>
  <text
     x="623.01373"
     y="111.16895"
     class="tiny"
     id="text33"
     style="font-style:normal;font-variant:normal;font-weight:500;font-stretch:normal;font-size:10px;line-height:normal;font-family:ui-sans-serif, system-ui, '-apple-system', 'Segoe UI', Roboto, 'Helvetica Neue', Arial">Q</text>
  <!-- Context down: attention right → each decoder cell top -->
  <!-- exit points spaced along attention right edge (x=820) -->
  <text
     x="824"
     y="52"
     class="tiny"
     id="text36">Concat ⟶ Wₒ</text>
  <!-- Output -->
  <g
     class="stateDot"
     id="g37">
    <circle
       cx="876"
       cy="236"
       r="10"
       id="circle36" />
  </g>
  <text
     x="866"
     y="256"
     class="lbl"
     text-anchor="middle"
     id="text37"
     style="font-style:normal;font-variant:normal;font-weight:600;font-stretch:normal;font-size:12px;line-height:normal;font-family:ui-sans-serif, system-ui, '-apple-system', 'Segoe UI', Roboto, 'Helvetica Neue', Arial">ŷ</text>
  <g
     class="wire"
     marker-end="url(#arrC)"
     id="g38">
    <path
       d="M798,236 H860"
       id="path37" />
  </g>
  <!-- Labels -->
  <text
     x="210"
     y="148"
     class="small"
     text-anchor="middle"
     fill="#f59e0b"
     id="text38">ENCODER</text>
  <text
     x="634"
     y="280"
     class="small"
     text-anchor="middle"
     fill="#3b82f6"
     id="text39">DECODER</text>
</svg>
