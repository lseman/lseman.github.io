<svg viewBox="0 0 700 280" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <marker id="arrB" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,8 L8,4 z" fill="#64748b" />
    </marker>
    <linearGradient id="gruGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f0fdf4"/>
      <stop offset="100%" style="stop-color:#dcfce7"/>
    </linearGradient>
  </defs>

  <style>
    .lbl{font-size:13px; fill:#374151; font-weight:500; font-family: Arial, sans-serif}
    .gate{fill:#fefefe;stroke:#6366f1;stroke-width:2;rx:12}
    .wire{stroke:#64748b;stroke-width:2.5;fill:none}
    .inDot{fill:#dbeafe;stroke:#3b82f6;stroke-width:2}
    .stateDot{fill:#dcfce7;stroke:#22c55e;stroke-width:2}
    .sigmoid{fill:#fef3c7;stroke:#f59e0b;stroke-width:2}
    .tanh-gate{fill:#f0f9ff;stroke:#0ea5e9;stroke-width:2}
    .multiply{fill:#fef2f2;stroke:#ef4444;stroke-width:2}
    .add{fill:#f0fdf4;stroke:#22c55e;stroke-width:2}
  </style>

  <!-- Background -->
  <rect x="15" y="15" width="670" height="250" fill="url(#gruGrad)" stroke="#cbd5e1" stroke-width="2" rx="20" opacity="0.3"/>

  <!-- Input nodes -->
  <g class="inDot">
    <circle cx="50" cy="80" r="16"/>
    <circle cx="50" cy="200" r="16"/>
  </g>
  <text x="50" y="62" class="lbl" text-anchor="middle">x_t</text>
  <text x="50" y="222" class="lbl" text-anchor="middle">h_{t-1}</text>

  <!-- Gates -->
  <rect x="150" y="60"  width="110" height="40" class="sigmoid"/>
  <rect x="150" y="120" width="110" height="40" class="sigmoid"/>
  <rect x="150" y="180" width="110" height="40" class="tanh-gate"/>
  
  <text x="205" y="84" class="lbl" text-anchor="middle">z_t (update)</text>
  <text x="205" y="144" class="lbl" text-anchor="middle">r_t (reset)</text>
  <text x="205" y="204" class="lbl" text-anchor="middle">h̃_t (candidate)</text>

  <!-- Input connections -->
  <g class="wire" marker-end="url(#arrB)">
    <!-- x_t to gates -->
    <path d="M66,80 H120 V80 H150"/>
    <path d="M120,80 V140 H150"/>
    <path d="M120,80 V200 H150"/>
    
    <!-- h_{t-1} to gates -->
    <path d="M66,200 H110 V80 H150"/>
    <path d="M110,200 V140 H150"/>
    <path d="M110,200 V200 H150"/>
  </g>

  <!-- Reset gate modulation -->
  <circle cx="350" cy="140" r="16" class="multiply"/>
  <text x="350" y="146" class="lbl" text-anchor="middle">×</text>
  
  <g class="wire" marker-end="url(#arrB)">
    <!-- Reset gate output to multiply -->
    <path d="M260,140 H334"/>
    <!-- h_{t-1} to reset multiply -->
    <path d="M110,200 H320 V140 H334"/>
    <!-- Reset result to candidate gate -->
    <path d="M366,140 H380 V200 H260"/>
  </g>

  <!-- Update gate computation: 1-z -->
  <rect x="320" y="60" width="60" height="30" class="gate"/>
  <text x="350" y="79" class="lbl" text-anchor="middle">1-z_t</text>
  
  <g class="wire" marker-end="url(#arrB)">
    <path d="M260,80 H320"/>
  </g>

  <!-- Final blending operations -->
  <circle cx="450" cy="100" r="16" class="multiply"/>
  <text x="450" y="106" class="lbl" text-anchor="middle">×</text>
  
  <circle cx="450" cy="160" r="16" class="multiply"/>
  <text x="450" y="166" class="lbl" text-anchor="middle">×</text>
  
  <circle cx="520" cy="130" r="16" class="add"/>
  <text x="520" y="136" class="lbl" text-anchor="middle">+</text>

  <g class="wire" marker-end="url(#arrB)">
    <!-- 1-z to first multiply -->
    <path d="M380,75 H430 V100 H434"/>
    
    <!-- h_{t-1} to first multiply -->
    <path d="M110,200 H420 V100 H434"/>
    
    <!-- z (update gate) to second multiply -->
    <path d="M260,80 H420 V160 H434"/>
    
    <!-- Candidate to second multiply -->
    <path d="M260,200 H420 V160 H434"/>
    
    <!-- Both multiplies to add -->
    <path d="M466,100 H500 V130 H504"/>
    <path d="M466,160 V130 H504"/>
    
    <!-- Final output -->
    <path d="M536,130 H620"/>
  </g>

  <!-- Output -->
  <g class="stateDot"><circle cx="620" cy="130" r="12"/></g>
  <text x="620" y="150" class="lbl" text-anchor="middle">h_t</text>

  <!-- Operation labels for clarity -->
  <text x="350" y="125" style="font-size:10px" text-anchor="middle" fill="#ef4444">r_t ⊗ h_{t-1}</text>
  <text x="450" y="85" style="font-size:10px" text-anchor="middle" fill="#22c55e">(1-z_t) ⊗ h_{t-1}</text>
  <text x="450" y="180" style="font-size:10px" text-anchor="middle" fill="#22c55e">z_t ⊗ h̃_t</text>
</svg>